Étant donné la complexité du processus de caractérisation du signal sans connaissances préalable de ses paramètres, une alternative est considérée.\\
Peut-on connaître à l'avance la séquence de saut de fréquences ?\\
%afin d'éviter un processus de détection/estimation des paramètres du signal?
La piste envisagée est celle de l'interception des paquets transmis entre deux appareils lors d'une communication Bluetooth.\\
En outre, la liaison de communication Bluetooth est basé sur le principe de l'évasion de fréquences et utilise le duplex par séparation temporelle (Time Division Duplex). \\
%Le maître transmets par séparation temporelle impaire et pair pour l'esclave.\\

Le système est caractérisé par deux états : standby et connection.\\
Sept sous-états le compose : Inquiry, Inquiry scan, Page, Page scan.\\


\subsection*{Saut de fréquences}    
La communication se fait en utilisant le principe de l'évasion de fréquences. La quantité de sauts possible dépends des normes, variant d'un pays à l'autre. En France, le système de 23 sauts est adopté.\\
Ainsi, 16 fréquences différentes équitablement reparties sur les 23 MHz sont utilisées pour la transmission de paquets.\\

Comme, avant toute connexion établie, l'horloge du maître et de l'esclave ne sont pas synchronisées, le maître ne peut déterminer avec certitude sur quelle fréquence et à quel moment l'esclave va se réveiller. Par conséquent, il transmet un même paquet à des fréquences différentes, pour ensuite écouter entre les intervalles de transmission jusqu'à ce qu'il reçoive une réponse de la part de l'esclave.

$$X_p^{(23)} = [CLKE_{15-12} +8 -CLKE_{4-2,0}] \ \text{mod 16} $$
Un décalage de 8 est utilisé pour démarrer avec $f(k-8)$ comme pour le système à 79 fréquences. On constate aussi que seulement 4 bits sont nécessaire étant donné que les additions sont modulo 16.\\
(Je ne rentre volontairement pas dans les détails pour éviter un rapport d'une trentaine de pages)\\

Afin de simplifier le développement du principe de communication Bluetooth, ne seront considéré que la communication entre deux dispositifs, un maître et un esclave.\\
De plus, trois modes de sécurité sont possibles. \\
Le premier est le mode non-sécurisé. Cela signifie que l'authentification et le cryptage ne sont pas utilisés.\\
Dans le deuxième mode, l'authentification et/ou le cryptage ne sont initiés au moment de l'établissement de la liaison mais peuvent être demandés lors de l'établissement de la connexion.\\
Enfin le troisième aura une identification et/ou cryptage avant même que la liaison ne soit établie.\\
Afin de simplifier la mise en place du système d'interception Bluetooth, le mode 1, sans identification/cryptage est choisi. \\

\subsection*{Inquiry}
Dans le but de déterminer les potentielles liaisons aux appareils se trouvant à proximité, l'équipement établissant les connexions, appelé maître, va entrer dans le sous-états \textit{inquiry}.\\

Tout d'abord, le maître va envoyer un premier paquet d'identification (ID1) vers l'esclave qui est dans le sous-état \textit{inquiry scan}, c'est-à-dire en écoute durant une fenêtre de temps de 11,25 ms.\\
Dès réception, celui-ci passe dans une période de random backoff de 0 à 1023 créneaux (slots) afin d'éviter toute collision, qui peut être négligeable dans notre cas.\\
Une fois le deuxième paquet d'identification (ID2) reçu de la part du maître, l'esclave entre dans sous-état \textit{inquiry response} au bout de 625 $\mu s$, correspondant à un slot.\\ En revanche si rien est reçu lors du temps imparti, il retourne dans l'état de \textit{standby}.\\
Une fois l'ID2 reçu, l'esclave va renvoyé un paquet riche d'informations, nommé \textit{Frequency Hop synchronisation} (FHS). \\
Lorsque le paquet FHS est reçu, le maître utilise l'adresse de l'autre appareil identifié pour déterminer le \textit{Device Access Code} (DAC) utilisant les 24 bits de poids faible. Le DAC va être utile lors de la \textit{Page procedure}.\\



\subsection*{Page}
Une fois l'identification de l'autre appareil réalisée, il faut établir une connexion entre les deux dispositifs.\\ L'appareil voulant établir la connexion est considéré comme le maître et à l'inverse l'esclave.
Le maître envoie son paquet identifiant (ID1) avec le code d'accès appareil (DAC) de l'esclave.\\
Comme il reconnaît son adresse, il passe dans sous-état \textit{page response} et l'horloge est gardée constante. Ensuite, il envoie un paquet ID2 au maître. \\
Une fois le paquet reçu, le maître rentre en réponse tout en fixant l'horloge et le paramètre $k_{offset}$ (dans le cas du système à 79 fréquences).\\
Dans ce sous-état, il va envoyer à l'esclave un paquet FHS, qui une fois reçu, lui enverra un paquet d'identification (ID3).\\
Pour finir, une fois que le maître a reçu ID3, il envoie le paquet POLL. Faisant office de confirmation de réception, l'esclave lui envoie un paquet NULL et la connexion est établie.\\



%à partir de la BD\_ADDR, la séquence des sauts est définie et la phase de la clock de l'esclave.\\
%Pour calculer la $CLKE_{15-12}$, le master ajoute un offset à son horloge.






L'interception peut se faire à l'aide d'un appareil défini dans le mode non-découverte. Ce mode permet à l'appareil d'ignorer les messages et son adresse n'est pas annoncée publiquement, afin de ne pas être identifié par le maître.
Afin d'obtenir la séquence permettant l'accès à la donnée, le scénario suivant est envisagé :\\
Lorsque les deux appareils (maître et esclave) sont dans la phase \textit{inquiry} ou \textit{page}, le paquet de synchronisation par saut de fréquence (FHS) est échangé. Or, ce paquet permet la  synchronisation des sauts de fréquence avant qu'un piconet n'ait été établi, et contient donc l'adresse et l'horloge de la cible. \\

À partir de ces informations, on utilise le système suivant : 

\begin{figure}[H]
\centering
\includegraphics[width=13cm]{block_diagram.png}
\caption{Diagramme de sélection des sauts pour le système à 23 fréquences}
\end{figure}



Ainsi, une fois que l'adresse (les 24 bits de poids faible et les 4 bits de poids fort) et l'horloge du maître sont connues, on peut en déduire la séquence du saut de fréquences et donc intercepter le signal.
%Dans le but de calculer la fréquence suivante, 4 variables sont nécessaires :
%En premier, la selection du système à 23 ou 79 sauts de fréquences.\\
%La deuxième est l'adresse $BD\_ADDR_{27-0}$\\
%La troisième est baser sur la même horloge CLKN, CLK et CLKE.\\
%La quatrième est le nombre de fois chaque "train de fréquences" (A_{train} et B_{train}) doivent être utilisés avant de les alterners


\section*{Estimation des paramètres}
Une fois la représentation temps-fréquence déterminer, le plus important est l'estimation des paramètres du signal afin de le caractériser.\\
Pour cela, une importante quantité de méthodes existe, mais elles ne sont pas toujours adaptées.\\
J'ai fait des recherches sur un certain nombre de méthodes tel que la méthode bayesienne, décomposition atomique, ...\\
En prenant un peu de recul, je me suis interrogé sur le fait que d'avoir l'ensemble des fréquences instantanées du signal peut permettre une bonne estimation de ses caractéristiques, sans avoir à passer par des méthodes relativement complexes et coûteuses en ressources. 